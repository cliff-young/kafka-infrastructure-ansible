- name: Configure Common environment
  include_tasks: common.yml

- name: Build Infrastructure
  include_tasks: vm.yml
  vars:
    vm_names: "{{groups['zookeeper'] + groups['kafka_broker'] + groups['schema_registry'] + groups['kafka_rest'] + groups['ksql'] + groups['kafka_connect'] + groups['control_center'] | unique}}"

# - name: Build Zookeeper Infrastructure
#   include_tasks: vm.yml
#   vars:
#     name: "{{item}}"
#   with_items: "{{groups['zookeeper']}}"

# - name: Build Broker Infrastructure
#   include_tasks: vm.yml
#   vars:
#     name: "{{item}}"
#   with_items: "{{groups['kafka_broker']}}"

# - name: Build Schema Registry
#   include_tasks: vm.yml
#   vars:
#     name: "{{item}}"
#   with_items: "{{groups['schema_registry']}}"

# - name: Build Kafka REST
#   include_tasks: vm.yml
#   vars:
#     name: "{{item}}"
#   with_items: "{{groups['kafka_rest']}}"

# - name: Build ksql
#   include_tasks: vm.yml
#   vars:
#     name: "{{item}}"
#   with_items: "{{groups['ksql']}}"

# - name: Build Connect
#   include_tasks: vm.yml
#   vars:
#     name: "{{item}}"
#   with_items: "{{groups['kafka_connect']}}"

# - name: Build Control Center
#   include_tasks: vm.yml
#   vars:
#     name: "{{item}}"
#   with_items: "{{groups['control_center']}}"